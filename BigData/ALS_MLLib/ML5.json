{"paragraphs":[{"text":"%spark2.pyspark\r\nfrom pyspark.ml.evaluation import RegressionEvaluator\r\nfrom pyspark.ml.recommendation import ALS\r\nfrom pyspark.sql import Row\r\n\r\n\r\n# Convert u.data lines into (userID, movieID, rating) rows\r\ndef parseInput(line):\r\n    fields = line.value.split()\r\n    return Row(userID = int(fields[0]), movieID = int(fields[1]), rating = float(fields[2]))\r\n\r\n# Get the raw data\r\nlines = spark.read.text(\"/__dsets/u.data\").rdd\r\n\r\n# Convert it to a RDD of Row objects with (userID, movieID, rating)\r\nratingsRDD = lines.map(parseInput)\r\n\r\n# Convert to a DataFrame and cache it\r\nratings = spark.createDataFrame(ratingsRDD).cache()\r\nratings.show(10)\r\n\r\n(training, test) = ratings.randomSplit([0.8, 0.2])\r\n\r\n# Create an ALS collaborative filtering model from the complete data set\r\nals = ALS(maxIter=5, regParam=0.01, userCol=\"userID\", itemCol=\"movieID\", ratingCol=\"rating\",coldStartStrategy=\"drop\")\r\n\r\nmodel1 = als.fit(training)\r\n\r\npredictions = model1.transform(test)\r\n\r\npredictions.show(10)\r\n\r\nevaluator = RegressionEvaluator(metricName=\"rmse\", labelCol=\"rating\",\r\n                                predictionCol=\"prediction\")\r\nrmse = evaluator.evaluate(predictions)\r\nprint(\"Root-mean-square error = \" + str(rmse))\r\n\r\n\r\n\r\n","dateUpdated":"2019-04-10T01:23:00+0000","config":{"lineNumbers":true,"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+------+\n|movieID|rating|userID|\n+-------+------+------+\n|    242|   3.0|   196|\n|    302|   3.0|   186|\n|    377|   1.0|    22|\n|     51|   2.0|   244|\n|    346|   1.0|   166|\n|    474|   4.0|   298|\n|    265|   2.0|   115|\n|    465|   5.0|   253|\n|    451|   3.0|   305|\n|     86|   3.0|     6|\n+-------+------+------+\nonly showing top 10 rows\n\n+-------+------+------+----------+\n|movieID|rating|userID|prediction|\n+-------+------+------+----------+\n|    148|   4.0|   602| 3.9126744|\n|    148|   3.0|   601| 0.9563824|\n|    148|   5.0|   416|  3.672167|\n|    148|   4.0|   935| 3.6934695|\n|    148|   2.0|   896| 2.2289805|\n|    148|   3.0|   308|   2.83759|\n|    148|   5.0|    20|  3.832047|\n|    148|   4.0|   923|  3.974025|\n|    148|   4.0|   447| 3.2197938|\n|    148|   3.0|   455| 2.9234197|\n+-------+------+------+----------+\nonly showing top 10 rows\n\nRoot-mean-square error = 1.07381993168\n"}]},"apps":[],"jobName":"paragraph_1554859380514_1427053656","id":"20190321-224155_2047365023","dateCreated":"2019-04-10T01:23:00+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26666"},{"text":"%sh\n head /root/u.item\n","dateUpdated":"2019-04-10T01:23:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1|Toy Story (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0\n2|GoldenEye (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?GoldenEye%20(1995)|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0\n3|Four Rooms (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Four%20Rooms%20(1995)|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0\n4|Get Shorty (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Get%20Shorty%20(1995)|0|1|0|0|0|1|0|0|1|0|0|0|0|0|0|0|0|0|0\n5|Copycat (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Copycat%20(1995)|0|0|0|0|0|0|1|0|1|0|0|0|0|0|0|0|1|0|0\n6|Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)|01-Jan-1995||http://us.imdb.com/Title?Yao+a+yao+yao+dao+waipo+qiao+(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0\n7|Twelve Monkeys (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Twelve%20Monkeys%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|1|0|0|0\n8|Babe (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Babe%20(1995)|0|0|0|0|1|1|0|0|1|0|0|0|0|0|0|0|0|0|0\n9|Dead Man Walking (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Dead%20Man%20Walking%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0\n10|Richard III (1995)|22-Jan-1996||http://us.imdb.com/M/title-exact?Richard%20III%20(1995)|0|0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|1|0\n"}]},"apps":[],"jobName":"paragraph_1554859380521_1422821418","id":"20190404-061708_1795012678","dateCreated":"2019-04-10T01:23:00+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:26667"},{"text":"%spark2.pyspark\nlines = spark.read.text(\"/__dsets/u.data\").rdd\n\n","dateUpdated":"2019-04-10T01:23:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554859380523_1423590915","id":"20190404-164906_591056169","dateCreated":"2019-04-10T01:23:00+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:26668"},{"text":"%spark2.pyspark\nlines = spark.read.text(\"/__dsets/u.data\").rdd","dateUpdated":"2019-04-10T01:23:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554859380525_1421282422","id":"20190408-154706_1432490633","dateCreated":"2019-04-10T01:23:00+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:26669"},{"text":"%spark2.pyspark\n","dateUpdated":"2019-04-10T01:23:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554859380526_1422436669","id":"20190408-192337_122976242","dateCreated":"2019-04-10T01:23:00+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:26670"}],"name":"ML5","id":"2E9NF7G9D","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}