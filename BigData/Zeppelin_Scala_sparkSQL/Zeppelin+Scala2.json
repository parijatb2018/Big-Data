{"paragraphs":[{"title":"Check Spark version","text":"sc.version","dateUpdated":"2019-04-10T19:46:44+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: String = 2.3.0.2.6.5.0-292\n"}]},"apps":[],"jobName":"paragraph_1554925604584_-2063515435","id":"20170209-153745_362251663","dateCreated":"2019-04-10T19:46:44+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:50058"},{"title":"Creating RDD","text":"%spark2.spark\r\n\r\nval sc= spark.sparkContext\r\n\r\nval lines = sc.textFile(\"/__dsets/rat.csv\")","user":"anonymous","dateUpdated":"2019-04-12T05:12:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sc: org.apache.spark.SparkContext = org.apache.spark.SparkContext@1d7a8bfa\nlines: org.apache.spark.rdd.RDD[String] = /__dsets/rat.csv MapPartitionsRDD[105] at textFile at <console>:46\n"}]},"apps":[],"jobName":"paragraph_1554925604590_-2064284933","id":"20190410-021146_1019885847","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T19:47:07+0000","dateFinished":"2019-04-10T19:47:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50059"},{"title":"Converting ratings data to a Spark DataFrame","text":"%spark2.spark\r\n\r\n\r\n//val sc= spark.sparkContext\r\n\r\nfinal case class Rating(movieID: Int, rating: Float)\r\n\r\nval lin = lines.map(x => {val fields = x.split(\",\"); Rating(fields(1).toInt, fields(2).toFloat)})\r\n\r\n\r\n// Convert to a DataFrame\r\nimport sqlContext.implicits._\r\n\r\nval ratingsDF = lin.toDF()\r\n\r\nratingsDF.printSchema()\r\n\r\nratingsDF.show()","user":"anonymous","dateUpdated":"2019-04-12T05:12:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlin: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[111] at map at <console>:51\nimport sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [movieID: int, rating: float]\nroot\n |-- movieID: integer (nullable = false)\n |-- rating: float (nullable = false)\n\n+-------+------+\n|movieID|rating|\n+-------+------+\n|      2|   3.5|\n|     29|   3.5|\n|     32|   3.5|\n|     47|   3.5|\n|     50|   3.5|\n|    112|   3.5|\n|    151|   4.0|\n|    223|   4.0|\n|    253|   4.0|\n|    260|   4.0|\n|    293|   4.0|\n|    296|   4.0|\n|    318|   4.0|\n|    337|   3.5|\n|    367|   3.5|\n|    541|   4.0|\n|    589|   3.5|\n|    593|   3.5|\n|    653|   3.0|\n|    919|   3.5|\n+-------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1554925604591_-2064669681","id":"20170209-155446_1506165769","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T19:49:54+0000","dateFinished":"2019-04-10T19:49:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50060"},{"title":"Finding most-rated movie IDs","text":"%spark2.spark\r\n// Some SQL-style magic to sort all movies by popularity in one line!\r\nval topMovieIDs = ratingsDF.groupBy(\"movieID\").count().orderBy(desc(\"count\")).cache()\r\n    \r\ntopMovieIDs.show()","user":"anonymous","dateUpdated":"2019-04-12T05:12:47+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topMovieIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieID: int, count: bigint]\n+-------+-----+\n|movieID|count|\n+-------+-----+\n|    296|67310|\n|    356|66172|\n|    318|63366|\n|    593|63299|\n|    480|59715|\n|    260|54502|\n|    110|53769|\n|    589|52244|\n|   2571|51334|\n|    527|50054|\n|      1|49695|\n|    457|49581|\n|    150|47777|\n|    780|47048|\n|     50|47006|\n|   1210|46839|\n|    592|46054|\n|   1196|45313|\n|   2858|44987|\n|     32|44980|\n+-------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1554925604591_-2064669681","id":"20170209-164156_1237996116","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T19:51:09+0000","dateFinished":"2019-04-10T19:51:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50061"},{"title":"Registering DF ratings as a SQL table","text":"topMovieIDs.registerTempTable(\"topMov\")\n","user":"anonymous","dateUpdated":"2019-04-12T03:59:26+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1554925604592_-2054281461","id":"20170209-160624_2046065823","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:12:15+0000","dateFinished":"2019-04-10T20:12:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50062"},{"title":"Query the ratings DataFrame via SparkSQL","text":"%sql\n\nSELECT * FROM topMov LIMIT 10\n\n","user":"anonymous","dateUpdated":"2019-04-12T05:12:59+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"movieID","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{},"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{}},"helium":{}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieID\tcount\n296\t67310\n356\t66172\n318\t63366\n593\t63299\n480\t59715\n260\t54502\n110\t53769\n589\t52244\n2571\t51334\n527\t50054\n"}]},"apps":[],"jobName":"paragraph_1554925604592_-2054281461","id":"20170209-162457_1569352528","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:33:52+0000","dateFinished":"2019-04-10T20:33:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50063"},{"text":"\n\nratingsDF.registerTempTable(\"ratings\")\n","user":"anonymous","dateUpdated":"2019-04-10T20:12:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1554925604593_-2054666210","id":"20190410-172754_1527732275","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:12:27+0000","dateFinished":"2019-04-10T20:12:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50064"},{"text":"%sql\n\nSELECT * FROM ratings LIMIT 10","user":"anonymous","dateUpdated":"2019-04-10T20:27:45+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieID\trating\n2\t3.5\n29\t3.5\n32\t3.5\n47\t3.5\n50\t3.5\n112\t3.5\n151\t4.0\n223\t4.0\n253\t4.0\n260\t4.0\n"}]},"apps":[],"jobName":"paragraph_1554925604593_-2054666210","id":"20190410-173040_256691097","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:12:37+0000","dateFinished":"2019-04-10T20:12:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50065"},{"title":"Rating Breakdown (visualization )","text":"%sql\nSELECT rating, COUNT(*) as count  FROM ratings GROUP BY rating\nORDER BY count DESC","user":"anonymous","dateUpdated":"2019-04-12T04:01:43+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"rating","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"rating","index":0,"aggr":"sum"}}},"helium":{}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\tcount\n4.0\t5561926\n3.0\t4291193\n5.0\t2898660\n3.5\t2200156\n4.5\t1534824\n2.0\t1430997\n2.5\t883398\n1.0\t680732\n1.5\t279252\n0.5\t239125\n"}]},"apps":[],"jobName":"paragraph_1554925604594_-2053511963","id":"20170209-162510_821025355","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:14:41+0000","dateFinished":"2019-04-10T20:15:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50066"},{"title":"Converting movie titles into a DataFrame","text":"final case class Movie(movieID: Int, title: String)\r\n\r\nval lines = sc.textFile(\"/__dsets/mov.csv\").map(x => {val fields = x.split(','); Movie(fields(0).toInt, fields(1))})\r\n\r\n// Convert to a DataFrame\r\nimport sqlContext.implicits._\r\nval moviesDF = lines.toDF()\r\n\r\nmoviesDF.show()\r\n","user":"anonymous","dateUpdated":"2019-04-12T05:13:12+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[142] at map at <console>:57\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n+-------+--------------------+\n|movieID|               title|\n+-------+--------------------+\n|      1|    Toy Story (1995)|\n|      2|      Jumanji (1995)|\n|      3|Grumpier Old Men ...|\n|      4|Waiting to Exhale...|\n|      5|Father of the Bri...|\n|      6|         Heat (1995)|\n|      7|      Sabrina (1995)|\n|      8| Tom and Huck (1995)|\n|      9| Sudden Death (1995)|\n|     10|    GoldenEye (1995)|\n|     11| \"American President|\n|     12|Dracula: Dead and...|\n|     13|        Balto (1995)|\n|     14|        Nixon (1995)|\n|     15|Cutthroat Island ...|\n|     16|       Casino (1995)|\n|     17|Sense and Sensibi...|\n|     18|   Four Rooms (1995)|\n|     19|Ace Ventura: When...|\n|     20|  Money Train (1995)|\n+-------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1554925604595_-2053896712","id":"20170209-162559_1194279704","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:11:56+0000","dateFinished":"2019-04-10T20:11:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50067"},{"title":"Expose titles as a SQL table","text":"moviesDF.registerTempTable(\"titles\")","user":"anonymous","dateUpdated":"2019-04-12T05:13:32+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1554925604595_-2053896712","id":"20170209-163125_1074972764","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:15:15+0000","dateFinished":"2019-04-10T20:15:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50068"},{"title":"Join ratings and titles to find most-rated movies with names","text":"%sql \n\nSELECT t.title, first(r.movieID), count(*) cnt FROM ratings r JOIN titles t ON r.movieID = t.movieID GROUP BY t.title ORDER BY cnt DESC LIMIT 5","user":"anonymous","dateUpdated":"2019-04-12T05:13:37+0000","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"title","index":0,"aggr":"sum"}],"values":[{"name":"cnt","index":2,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"title","index":0,"aggr":"sum"},"yAxis":{"name":"cnt","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{}},"commonSetting":{}},"helium":{}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tfirst(movieID, false)\tcnt\nPulp Fiction (1994)\t296\t67310\nForrest Gump (1994)\t356\t66172\n\"Shawshank Redemption\t318\t63366\n\"Silence of the Lambs\t593\t63299\nJurassic Park (1993)\t480\t59715\n"}]},"apps":[],"jobName":"paragraph_1554925604596_-2055820457","id":"20170209-163536_419383592","dateCreated":"2019-04-10T19:46:44+0000","dateStarted":"2019-04-10T20:25:09+0000","dateFinished":"2019-04-10T20:26:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50069"},{"dateUpdated":"2019-04-10T19:46:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[],"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1554925604597_-2056205206","id":"20170209-163736_1774997433","dateCreated":"2019-04-10T19:46:44+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:50070"}],"name":"Zeppelin+Scala2","id":"2E96CC39A","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}